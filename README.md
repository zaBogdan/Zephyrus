# Zephyrus
<p align="center">
  <img src="https://imgur.com/uHDcZyk.jpg" alt="New logo"/>
</p>
This is a Content Management System created for learning purposes. It has suffered a lot of changes and improves during this commits. If you want to see a changelog of this look at the Versions. Project is not regularly maintained and can have severe security issues because of the little time I have.

# Linux/MacOS installation using Docker Compose
In the hope that I will be able to migrate fast from one computer to another I've migrated the whole project to Docker containers using them along with Docker-Compose. 
Here is what you have to do
* You must have `docker` and `docker compose` installed on your system!
* Clone the repository `git clone https://github.com/zaBogdan/Zephyrus.git`
* Change the directory to `cd Zephyrus`
* Open `.env.example` and change the `DB_ROOT_PASSWORD` and `DB_USER_PASSWORD` to secure  passwords. We recommand passwords longer that 16 characters. 
* Change `.env.example` to `.env`
* Run `chmod +x build.sh`
* Now just execute `./build.sh` and it will take care of everything 

Post installation things to do 
* If you want to start the containters use `docker-compose start`
* If you want to close them use `docker-compose stop`
* If you want to benefit from mail services I've implemented them  using Mailgun, so you will need an account to login.
* Because the scope of this project was to learn how PHP works and to improve it as much as I can I didn't focus on writing a from scratch text editor so I've used Twig. You will also need an API key.

This script was tested on 
* Arch Linux (5.9.8-arch1-1)
* MacOS Big Sur

# Future plans
Even if it's in an alpha stage this project will be maintained but it will not have regular updates, because I am short on time. Hopefully it will become one day a powerful, scalable CMS.

These are some features I want to add:
- [ ] Manage Images & Videos (FileSystem)
- [x] Posts (TextSystem)
- [ ] Manage content generated by users (ModerationSystem)
- [ ] Pretty urls (URL Parser)
- [ ] User interactions & communication (InteractionSystem)
- [ ] Working with data (StatisticsSystem)
- [ ] Handling errors and requests (AuditSystem)
- [ ] Smart rendering for pages

# Known bugs
These are the bugs found during pentesting session. If you find more please inform me. 

> **Note** Not all bugs found here are solved. at the end there are specified vulnerable versions.

- [ ] There is no way to get administrator using the front-end/back-end logic. You must manually change it from the phpmyadmin > Zephyrus > users. I will implement it in the following version. For now, insert the following querry: 
```
UPDATE `users` SET `data`='{"firstname":"demo","lastname":"demo","registrationDate":1606411771,"role":"Administrator","status":"confirmed","special_perms":[],"image":"https:\/\/via.placeholder.com\/150\/008000\/FFFFFF\/64x64.png?text=DD"}' WHERE id=1
```
> Note: you just need to change from the `data` column json attribute `role` into `Administrator` (it is case sensitive!!)
- [x] Session cookies are not encrypted. (<0.4)
- [x] Remote code execution in `Upload Files` page. (<0.4)
- [x] Tokens are the same as UUID, not generated securely. (<0.4)
- [x] You can't install the application if you are not logged in, and you can't login because there is no database. (Only for 0.3)
- [x] Emails lose their style (<0.3)
- [x] A valid token can be used anywhere, no matter of it's scope (<0.2)

# Next updates
Because this version is working-ish (it still has a few installation bugs) I've decided to set this repository to public. Well the work for version 0.5 will be done on `development-0.5` branch. 


# Versions

This application is in early Alpha stage ( 0.4 current stable build ) !
Legend:
```json
+ New feature added
? Planned to be realised
- Feature removed.
! Bug/Security issue fixed
```
Version 0.4 - Almost there!
- (+) Project is now restructured. 
- (+) Service installation stage completed.
- (+) Project files restructured. (backend is now separated from frontend)
- (+) Docker has been added to the project.
- (+) Tokens now generate securely and use Selector:Validation schema.
- (+) Authentification system (Sessions) is now more secure and checks are made properly.
- (+) Roles for users
- (+) Rebranded from `zaEngine` to `Zephyrus`
- (+) Posts are now completed
- (+) Home, Posts and Profile pages are now working and linked.
- (-) Removed first installation system, redesigned a new one.
- (-) Removed old system of token & session generation. Now everything is more secure.
- (-) FileSystem is removed for this update. Will be taken care of in the next one.
> **Note** At this moment this version is in it's late beta. Don't install this on your production system!

Version 0.3
- (+) Posts added, early stage.
- (+) Automatic installation, first thing that you must do.
- (+) Fixes for newer mysql and php versions.
- (+) Twig rendering added, early stage.
- (!) You can't install the application if you are not logged in, and you can't login because there is no database.
- (!) Remote code execution in `Upload Files` page.
- (!) Tokens are the same as UUID, not generated securely. 

Version 0.2
- (+) Security bugs fixed, Tokens now have specific usage, they are linked to a specific user and can be used for a specific task, before being revoked.
- (+) File upload system added, with implementation that can be used for future extensions
- (+) Mail system with 'Account confirmation' and 'Password reset' futures added.
- (-) Removed early stage mail ( not working on UNIX based systems )
- (+) Now sensitive information is stored in 'vendor/env.php' file

Version 0.1
- (+) TokenAuth based authentication, UUID and Secure generated Tokens for all kinds of tasks
- (+) Users added with automatic handling of some events
- (+) Database communication and handle input/output
